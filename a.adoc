=== Webpack ç®€æ˜“æŒ‡å—

ç®€å•æ¥è¯´ï¼ŒWebpack æ˜¯ä¸€ä¸ªå‰ç«¯æ‰“åŒ…å·¥å…·ã€‚éšç€ä¼—å¤š JavaScript æ¡†æ¶çš„æµè¡Œï¼ŒWebpack æˆä¸ºç›®å‰æœ€å—æ¬¢è¿çš„æ¨¡å—åŒ–æ„å»ºå·¥å…·

åœ¨ Webpack å‡ºç°ä¹‹å‰ï¼Œå‰ç«¯å¼€å‘ä¹Ÿæœ‰è®¸å¤šç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆ

* Bower
* Gulp.js
* Browserify
* Asset Pipeline

Bower ä¸»è¦è§£å†³äº†ç¬¬ä¸‰æ–¹ä¾èµ–ç‰ˆæœ¬æ›´æ–°çš„é—®é¢˜ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œèµ„æºä¼šæ”¾åœ¨ _bower_components_ ç›®å½•é‡Œï¼Œä½†éœ€è¦å¼€å‘è€…æŠŠè¿™ä¸ªç›®å½•è®¾ç½®ä¸ºé™æ€æ–‡ä»¶æœåŠ¡ï¼Œå¹¶åœ¨ HTML æ–‡ä»¶ä¸­åŠ å…¥å¼•ç”¨æ ‡ç­¾

```HTML
<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <link rel="stylesheet" href="/bower_components/normalize.css/normalize.css">
    <link rel="stylesheet" href="/assets/application.css">
  </head>
  <body>
    <script src="/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/bower_components/jquery-ujs/src/rails.js"></script>
    <script src="/asset/application.js"></script>
  </body>
</html>
```

éšç€é¡¹ç›®å¤æ‚åº¦çš„æå‡ï¼Œéœ€è¦å¼•ç”¨çš„èµ„æºè¶Šæ¥è¶Šå¤šã€‚ä¸ºäº†æå‡ç½‘ç«™æ•´ä½“çš„åŠ è½½é€Ÿåº¦ï¼Œæˆ‘ä»¬éœ€è¦åˆç†æ§åˆ¶é“¾æ¥è¯·æ±‚æ•°ï¼Œä»¥åŠå¯¹èµ„æºï¼ˆå†…å®¹ï¼‰è¿›è¡Œå‹ç¼©

Gulp.js æ˜¯ç›®å‰ä¸»æµçš„å‰ç«¯æ„å»ºå·¥å…·ã€‚å®ƒå¯ä»¥è®©å¼€å‘è€…åˆ©ç”¨æ’ä»¶è‡ªä¸»å®šåˆ¶æ„å»ºæµç¨‹

|===
| gulp-csso   | å¯¹ CSS èµ„æºè¿›è¡Œå‹ç¼©
| gulp-uglify | å¯¹ JavaScript èµ„æºè¿›è¡Œå‹ç¼©
| gulp-concat | å¯¹å¤šä¸ªç›¸åŒç±»å‹çš„èµ„æºæ–‡ä»¶è¿›è¡Œåˆå¹¶
|===

ç”±äº NodeJS å¹³å°çš„å‡ºç°ï¼ŒJavaScript æˆä¸ºå‰åç«¯é€šç”¨è¯­è¨€ã€‚Browserify ä¸ºæµè§ˆå™¨ç«¯å¼€å‘æä¾›äº†ä¸ NodeJS å¹³å°ä¸€è‡´çš„æ¨¡å—åŠ è½½æœºåˆ¶ï¼ˆCommonJS è§„èŒƒï¼‰

å®‰è£… Browserify

```
npm install browserify --save-dev
```

å®‰è£…ç¬¬ä¸‰æ–¹ä¾èµ– `lodash`

```
npm install lodash --save
```

_entry.js_

```javascript
const uniq = require('lodash/uniq')

console.log(uniq(['ğŸ‰', 1, 0, 1]))
```

è¿è¡Œä»£ç 

```
npx browserify entry.js | node
```

ç”Ÿæˆä»£ç 

```
npx browserify entry.js -o assets/application.js
```

2008 å¹´ï¼ŒRails ç¤¾åŒºä¸ºå¼€å‘è€…æä¾›äº†å‰ç«¯è‡ªåŠ¨åŒ–æ„å»ºæ–¹æ¡ˆ - Asset Pipelineã€‚å®ƒé»˜è®¤æ”¯æŒ Sass å’Œ CoffeeScript é¢„å¤„ç†ï¼ˆç¼–è¯‘ï¼‰ï¼Œå¹¶å¯¹ CSS å’Œ JavaScript èµ„æºè¿›è¡Œåˆå¹¶ä¸å‹ç¼©

_app/assets/stylesheets_

```sass
//= require normalize.css
```

_app/assets/javascripts_

```javascript
//= require jquery
//= require jquery_ujs
```

Asset Pipeline ä¼šæ ¹æ®æ³¨é‡Šå†…å®¹çš„è¯­æ³•ä¾æ¬¡åŠ è½½ç¬¬ä¸‰æ–¹ä¾èµ–

2016 å¹´ï¼ŒRails çš„åˆ›é€ è€… DHH å¼€å§‹å°† Webpack å¼•å…¥æ¡†æ¶ä¹‹ä¸­ï¼Œå–å Webpacker

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ­å»ºä¸€ä¸ªåŸºäº Webpack çš„å‰ç«¯é¡¹ç›®

å‡è®¾æœ‰ä»¥ä¸‹å·¥ä½œç›®å½•

```
.
â””â”€â”€ package.json

0 directories, 1 file
```

é€šè¿‡å‘½ä»¤è¡Œå®‰è£… Webpack

```
npm install webpack webpack-cli --save-dev
```

åˆ›å»ºå…¥å£æ–‡ä»¶ _entry.js_

```javascript
console.log('ğŸ‰')
```

è¿è¡Œ Webpack

```
npx webpack entry.js --mode development
```

Webpack é»˜è®¤è¾“å‡ºæ–‡ä»¶ _dist/main.js_

å¦‚æœä½ æƒ³è¦è¾“å‡ºåˆ° _assets/application.js_ï¼Œå¯ä»¥è¿è¡Œ

```
npx webpack entry.js --mode development -o assets/application.js
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ _webpackfile.js_

```javascript
const { join } = require('path')

module.exports = {
  entry: './entry.js',
  output: {
    filename: 'application.js',
    path: join(__dirname, 'assets')
  }
}
```

è¿è¡Œ `npx webpack --mode development`

```
Hash: 6090b020231c0a9368aa
Version: webpack 4.21.0
Time: 123ms
Built at: 2018/10/20 ä¸‹åˆ11:44:59
         Asset      Size  Chunks             Chunk Names
application.js  3.76 KiB    main  [emitted]  main
Entrypoint main = application.js
[./entry.js] 18 bytes {main} [built]
```

å®‰è£…ç¬¬ä¸‰æ–¹ä¾èµ– `esm`ï¼Œè®© NodeJS è¿è¡Œç¯å¢ƒæ”¯æŒ ECMAScript æ¨¡å—è¯­æ³•

```
npm install esm --save-dev
```

è¿è¡Œ Webpack çš„æ—¶å€™ï¼ŒåŠ ä¸Š `--require` å‚æ•°

```
npx webpack --require esm --mode development
```

å®‰è£…ç¬¬ä¸‰æ–¹ä¾èµ– `lodash`

```
npm install lodash --save
```

ä¿®æ”¹ _entry.js_

```javascript
const uniq = require('lodash/uniq')

console.log(uniq(['ğŸ‰', 1, 0, 1]))
```

ç”Ÿæˆä»£ç 

```
npx webpack --require esm --mode development
```

è¿è¡Œä»£ç 

```
node assets/application.js
```
